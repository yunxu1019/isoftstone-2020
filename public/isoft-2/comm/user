03idata,isFunction,Error,Date,Function,extend,enrich,f,i,j,g,k,l,mvar c='userinfo',d=f.getInstance(c),h={name:'',_id:'',_passport:'',avatar:null,isLogin:!1,roles:null},e,a={targetUrl:null,loginPath:null,session_time:3e5,session:'',setStateFunction:function(a){if(!i(a))throw new j('\u53ea\u80fd\u4f20\u5165\u51fd\u6570\u7c7b\u578b\u7684\u53c2\u6570')},loadSession:function(){var b=d;return b.session&&!(new g>b.session_time)&&(a.session_time=b.session_time,a.session=b.session,this.Login(b)),b.session||''},setSessionTime:function(b){a.session_time=b},saveSession:function(b){b===void 0&&(b=this.session),this.session=b,f.setInstance(c,{roles:a.roles,name:a.name,_id:a._id,session:b,_passport:this._passport,isLogin:!!b,session_time:+new g+a.session_time})},Login:function(c){a.roles=c.roles||[],a.isLogin=!0,a.name=c.name,a._id='org.couchdb.user:'+c.name,b.clean&&b.clean(a.loginPath),this.refresh()},setUserDataLoader:function(a){e=a},refresh:function(){e instanceof k&&e()},Logout:function(){delete b.isLogin,delete b.roles,delete b._passport,a._passport='',a.roles=null,a.isLogin=!1,this.saveSession('')},setLoginPath:function(b){a.loginPath=b}};l(a,h,d);var b=m(a);return b